<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>PQC AES Encryption App</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-light">

<div class="container my-5">
    <h1 class="mb-4 text-center">ğŸ” Post-Quantum Encryption App (Kyber512 + AES)</h1>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- Key Section -->
    <div class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
            <strong>Session Keys</strong>
            <form method="POST" class="m-0">
                <button name="generate_keys" type="submit" class="btn btn-sm btn-outline-primary">ğŸ” Generate New Keys</button>
            </form>
        </div>
        <div class="card-body">
            <label class="form-label">Public Key (Base64)</label>
            <textarea class="form-control mb-3" rows="3" readonly>{{ public_key }}</textarea>

            <label class="form-label">Secret Key (Base64)</label>
            <textarea class="form-control" rows="3" readonly>{{ secret_key }}</textarea>
        </div>
    </div>

    <!-- Encryption Section -->
    <div class="card mb-4">
        <div class="card-header"><strong>Encrypt a Message</strong></div>
        <div class="card-body">
            <form method="POST">
                <div class="mb-3">
                    <input type="text" name="message" class="form-control" placeholder="Enter message to encrypt" required>
                </div>
                <button name="encrypt" type="submit" class="btn btn-success">ğŸ”’ Encrypt</button>
            </form>

            {% if encrypted_message %}
            <div class="mt-4">
                <label class="form-label">Encrypted Message (Base64)</label>
                <textarea class="form-control mb-3" rows="3" readonly>{{ encrypted_message }}</textarea>

                <label class="form-label">KEM Ciphertext (Base64)</label>
                <textarea class="form-control" rows="3" readonly>{{ kem_ciphertext }}</textarea>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Decryption Section -->
    <div class="card mb-4">
        <div class="card-header"><strong>Decrypt a Message</strong></div>
        <div class="card-body">
            <form method="POST">
                <div class="mb-3">
                    <input type="text" name="encrypted_message" class="form-control" placeholder="Paste encrypted message" required>
                </div>
                <div class="mb-3">
                    <input type="text" name="kem_ciphertext" class="form-control" placeholder="Paste KEM ciphertext" required>
                </div>
                <button name="decrypt" type="submit" class="btn btn-primary">ğŸ”“ Decrypt</button>
            </form>

            {% if decrypted_message %}
            <div class="mt-4">
                <label class="form-label">Decrypted Message</label>
                <textarea class="form-control" rows="3" readonly>{{ decrypted_message }}</textarea>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>